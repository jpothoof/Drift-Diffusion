import numpy as np
import matplotlib.pyplot as plt
from scipy import special

a1,b1,c1,a2,b2,c2 = [ 1.04633244e+00,  1.99709309e+03, -1.52480044e+00,  1.07114122e+00,
  6.50014924e+03, -4.51527387e+00]
# Parameters for sum of sines fit

pini = 9.634885e14    #Initial peak positive charge density
nini = -8.434762e14   #Initial peak negative charge density
k1 = 1.8
p1 = 17               #Parameters to fit charge density equations
k2 = 17
p2 = 1.8
l = 0.00134901960784314

x = np.linspace(0,l,134)

y01 = pini*((special.gamma(k1+p1))/(special.gamma(k1)*special.gamma(p1))*((x/l)**(k1-1))*(1-(x/l))**(p1-1))/7.3572
# Initial positive ion charge density
y001 = pini*np.exp(-1000*x)

y02 = nini*((special.gamma(k2+p2))/(special.gamma(k2)*special.gamma(p2))*((x/l)**(k2-1))*(1-(x/l))**(p2-1))/7.3572
# Initial negative ion charge density

y03 = a1*np.sin(b1*x+c1) + a2*np.sin(b2*x+c2)
# Initial potential

plt.figure(1)
plt.subplot(2,1,1)
plt.plot(x,y03)
plt.xlabel('Position / cm')
plt.ylabel('Potential / V')
plt.title('Potential Fit')

plt.subplot(2,2,3)
plt.plot(x,y01)
plt.xlabel('Position / cm')
plt.ylabel('Charge Density / cm^-3')
plt.title('Positive Charge Density Fit',y=1.08)

plt.subplot(2,2,4)
plt.plot(x,y02)
plt.xlabel('Position / cm')
plt.ylabel('Charge Density / cm^-3')
plt.title('Negative Charge Density Fit',y=1.08)
plt.subplots_adjust(wspace=0.5,hspace=0.6)

#plt.show()

Jp = (0.00000000e+00,  8.43858997e+10,  5.38821397e+10,  3.53816377e+10,
   2.24687930e+10,  1.30562061e+10,  6.08725440e+09,  9.14723559e+08,
  -2.90045936e+09, -5.67449487e+09, -7.64362228e+09, -8.98851111e+09,
  -9.84943095e+09, -1.03363464e+10, -1.05359867e+10, -1.05169913e+10,
  -1.03337642e+10, -1.00294238e+10, -9.63809761e+09, -9.18672692e+09,
  -8.69649909e+09, -8.18399037e+09, -7.66208157e+09, -7.14069361e+09,
  -6.62737907e+09, -6.12779834e+09, -5.64610277e+09, -5.18524289e+09,
  -4.74721621e+09, -4.33326622e+09, -3.94404223e+09, -3.57972755e+09,
  -3.24014233e+09, -2.92482612e+09, -2.63310414e+09, -2.36414061e+09,
  -2.11698161e+09, -1.89058982e+09, -1.68387250e+09, -1.49570425e+09,
  -1.32494554e+09, -1.17045767e+09, -1.03111507e+09, -9.05815147e+08,
  -7.93486311e+08, -6.93094316e+08, -6.03647248e+08, -5.24199319e+08,
  -4.53853641e+08, -3.91764091e+08, -3.37136407e+08, -2.89228584e+08,
  -2.47350679e+08, -2.10864100e+08, -1.79180443e+08, -1.51759962e+08,
  -1.28109721e+08, -1.07781504e+08, -9.03695255e+07, -7.55080026e+07,
  -6.28686317e+07, -5.21580173e+07, -4.31150873e+07, -3.55085317e+07,
  -2.91342927e+07, -2.38131310e+07, -1.93882899e+07, -1.57232707e+07,
  -1.26997345e+07, -1.02155371e+07, -8.18290235e+06, -6.52673712e+06,
  -5.18308714e+06, -4.09773132e+06, -3.22491065e+06, -2.52618598e+06,
  -1.96941788e+06, -1.52786131e+06, -1.17936680e+06, -9.05679890e+05,
  -6.91830342e+05, -5.25602764e+05, -3.97080419e+05, -2.98254407e+05,
  -2.22690812e+05, -1.65248842e+05, -1.21843559e+05, -8.92473172e+04,
  -6.49245636e+04, -4.68952372e+04, -3.36224796e+04, -2.39209031e+04,
  -1.68821148e+04, -1.18146319e+04, -8.19571888e+03, -5.63303369e+03,
  -3.83429041e+03, -2.58342736e+03, -1.72201832e+03, -1.13487882e+03,
  -7.39004734e+02, -4.75138071e+02, -3.01388075e+02, -1.88447710e+02,
  -1.16038230e+02, -7.02911375e+01, -4.18392808e+01, -2.44394351e+01,
  -1.39893211e+01, -7.83433526e+00, -4.28473342e+00, -2.28390527e+00,
  -1.18376238e+00, -5.95037636e-01, -2.89210692e-01, -1.35448102e-01,
  -6.08805999e-02, -2.61395039e-02, -1.06617763e-02, -4.10413289e-03,
  -1.47924534e-03, -4.94433061e-04, -1.51449170e-04, -4.18846061e-05,
  -1.02616760e-05, -2.17268885e-06, -3.84591640e-07, -5.43725517e-08,
  -5.75073629e-09, -4.12441289e-10, -1.71415070e-11, -3.13671837e-13,
  -1.45550981e-15, -4.13231427e-19,  0.00000000e+00,)

Jn = (0.00000000e+00, -3.61759247e-19, -1.27422529e-15, -2.74657108e-13,
  -1.50198184e-11, -3.61871491e-10, -5.05538315e-09, -4.79146863e-08,
  -3.39877376e-07, -1.92614378e-06, -9.12807506e-06, -3.73900694e-05,
  -1.35691983e-04, -4.44631464e-04, -1.33516528e-03, -3.71785804e-03,
  -9.69237790e-03, -2.38429084e-02, -5.57074245e-02, -1.24299805e-01,
  -2.66101215e-01, -5.48737647e-01, -1.09372323e+00, -2.11330007e+00,
  -3.96870171e+00, -7.26030147e+00, -1.29643080e+01, -2.26362136e+01,
  -3.87083992e+01, -6.49185238e+01, -1.06916978e+02, -1.73116229e+02,
  -2.75862839e+02, -4.33034827e+02, -6.70193527e+02, -1.02345074e+03,
  -1.54324961e+03, -2.29930172e+03, -3.38697500e+03, -4.93548657e+03,
  -7.11832461e+03, -1.01664030e+04, -1.43845443e+04, -2.01719914e+04,
  -2.80477690e+04, -3.86818522e+04, -5.29332578e+04, -7.18963535e+04,
  -9.69568881e+04, -1.29859483e+05, -1.72788604e+05, -2.28465348e+05,
  -3.00262754e+05, -3.92342783e+05, -5.09818602e+05, -6.58946411e+05,
  -8.47351729e+05, -1.08429583e+06, -1.38098896e+06, -1.75095805e+06,
  -2.21047778e+06, -2.77907527e+06, -3.48012037e+06, -4.34151502e+06,
  -5.39649739e+06, -6.68457855e+06, -8.25263176e+06, -1.01561571e+07,
  -1.24607467e+07, -1.52437790e+07, -1.85963725e+07, -2.26256330e+07,
  -2.74572306e+07, -3.32383456e+07, -4.01410214e+07, -4.83659695e+07,
  -5.81468638e+07, -6.97551685e+07, -8.35055335e+07, -9.97617922e+07,
  -1.18943586e+08, -1.41533631e+08, -1.68085625e+08, -1.99232781e+08,
  -2.35696945e+08, -2.78298230e+08, -3.27965052e+08, -3.85744441e+08,
  -4.52812410e+08, -5.30484128e+08, -6.20223579e+08, -7.23652290e+08,
  -8.42556631e+08, -9.78893077e+08, -1.13479071e+09, -1.31255013e+09,
  -1.51463766e+09, -1.74367390e+09, -2.00241496e+09, -2.29372512e+09,
  -2.62053890e+09, -2.98581074e+09, -3.39244975e+09, -3.84323720e+09,
  -4.34072368e+09, -4.88710278e+09, -5.48405748e+09, -6.13257538e+09,
  -6.83272784e+09, -7.58340806e+09, -8.38202183e+09, -9.22412426e+09,
  -1.01029943e+10, -1.10091375e+10, -1.19297059e+10, -1.28478197e+10,
  -1.37417753e+10, -1.45841135e+10, -1.53405207e+10, -1.59685196e+10,
  -1.64158923e+10, -1.66187521e+10, -1.64991382e+10, -1.59619412e+10,
  -1.48908461e+10, -1.31427684e+10, -1.05398493e+10, -6.85723972e+09,
  -1.80304835e+09,  5.01775000e+09,  1.41766185e+10,  2.65977236e+10,
   4.41101408e+10,  7.24179593e+10,  0.00000000e+00)

potential = (0.00517344, -0.00974038, -0.02872018, -0.05167712, -0.07850339, -0.10907271,
 -0.14324082, -0.1808462,  -0.22171068, -0.26564031, -0.31242614, -0.36184518,
 -0.41366134, -0.4676265,  -0.52348159, -0.5809577,  -0.6397773,  -0.6996554,
 -0.76030087, -0.82141768, -0.88270617, -0.94386444, -1.00458961, -1.06457919,
 -1.12353238, -1.18115143, -1.23714293, -1.29121909, -1.34309903, -1.39251001,
 -1.43918865, -1.48288207, -1.52334901, -1.56036093, -1.59370299, -1.62317504,
 -1.64859247, -1.66978707, -1.68660777, -1.69892132, -1.70661292, -1.70958668,
 -1.70776614, -1.70109458, -1.6895353,  -1.67307181, -1.65170794, -1.62546784,
 -1.59439589, -1.55855658, -1.51803419, -1.47293253, -1.42337445, -1.36950139,
 -1.31147276, -1.24946529, -1.18367231, -1.1143029,  -1.04158105, -0.96574472,
 -0.8870448, -0.80574409, -0.72211618, -0.63644427, -0.54902002, -0.46014228,
 -0.37011582, -0.27925006, -0.18785776, -0.09625369, -0.00475326,  0.08632874,
  0.17667955,  0.26598973,  0.35395446,  0.44027485,  0.52465921,  0.60682425,
  0.68649632,  0.76341254,  0.8373219,   0.90798634,  0.97518173,  1.03869882,
  1.09834413,  1.15394072,  1.20532895,  1.25236714,  1.29493216,  1.3329199,
  1.36624571,  1.39484476,  1.41867223,  1.43770352,  1.45193431,  1.46138054,
  1.46607833,  1.46608376,  1.46147261,  1.45234002,  1.43880002,  1.42098498,
  1.39904508,  1.37314756,  1.34347599,  1.31022944,  1.27362157,  1.23387973,
  1.19124387,  1.1459655,   1.09830659,  1.04853838,  0.9969402,   0.94379817,
  0.88940403,  0.83405374,  0.77804627,  0.72168218,  0.66526237,  0.60908672,
  0.55345275,  0.49865432,  0.44498032,  0.39271343,  0.34212882,  0.29349298,
  0.2470625 ,  0.20308298,  0.1617879,   0.12339764,  0.08811845,  0.05614159,
  0.02764244,  0.00277975)
plt.figure(2)
Jp = np.array(Jp)
Jn = np.array(Jn)
x = np.linspace(0, l, 134)
plt.plot(x,potential)
plt.show()